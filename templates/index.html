<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ノーツ変換</title>
</head>
<body>
<h1>ノーツ変換</h1>

<form method="POST" enctype="multipart/form-data">
    <h3>JSONファイルアップロード</h3>
    <input type="file" name="file">
    <button type="submit">変換</button>
</form>

<form method="POST">
    <h3>JSONテキストコピペ</h3>
    <textarea name="json_text" rows="10" cols="50" placeholder='JSONをここに貼り付け'></textarea><br>
    <button type="submit">変換</button>
</form>

<h3>変換結果</h3>
<textarea id="result" rows="20" cols="80">{{ converted_text }}</textarea><br>

<button onclick="copyText()">コピー</button>
<button onclick="downloadText()">TXTとしてダウンロード</button>

<script>
function copyText() {
    const result = document.getElementById("result");
    result.select();
    result.setSelectionRange(0, 99999);
    document.execCommand("copy");
    alert("コピーしました！");
}

function downloadText() {
    const text = document.getElementById("result").value;
    const blob = new Blob([text], { type: "text/plain" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "converted_notes.txt";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}
</script>
</body>
</html>
